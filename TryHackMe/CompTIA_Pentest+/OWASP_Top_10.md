# OWASP Top 10 Module

## Command Injection Practial


What strange text file is in the website root directory? **drpepper.txt**
> **Explain:** Using the `ls -a` command you will get a list of all files in current directory (you can check path of current directory by using `pwd` command)

How many non-root/non-service/non-daemon users are there? **0**
> **Explain:** run the `ping -c 1 10.x.x.x; ps -ef` command

What user is this app running as? **www-data**
> **Explain:** run the `whoami` command

What is the user's shell set as? **/usr/sbin/nlogin**
> **Explain:** this information can be located in the /etc/passwd file using the command `cat /etc/passwd | grep www-data`

What version of Ubuntu is running? **18.04.4**
> **Explain:** run the command `lsb_release -a`

Print out the MOTD (message of the day.  What favorite beverage is shown?
> **Explain:** The /etc/motd is a file on Unix-like systems that contains a “message of the day”, used to send a common message to all users in a more efficient manner than sending them all an e-mail message. To locate a specific MOTD file and to read its content we run the command `cat /etc/update-motd.d/00-header` command. The 00-header you will get from the hint of the question.

## Broken Authentication Practical

What is the flag that you found in darren's account? **fe86079416a21a3c99937fea8874b667**

Now try to do the same trick and see if you can login as arthur. What is the flag that you found in arthur's account? **d9ac0f7db4fda460ac3edeb75d75e16e**

## Sensitive Data Exposure

What is the name of the mentioned directory? **/assets**
> **Explain:** inspecting the login page, there is a comment telling us where the database is stored

Navigate to the directory you found in question one. What file stands out as being likely to contain sensitive data? **webapp.db**
> **Explain:** go to the `/assets` directory and you'll see the database at the bottom

Use the supporting material to access the sensitive data. What is the password hash of the admin user?
> **Explained:** check the tipe of database file it is `file webapp.db` then use the following command to access the database `sqlite3 webapp.db`

```
└─$ sqlite3 webapp.db                                                                                                                                                                                                                    1 ⚙
SQLite version 3.40.0 2022-11-16 12:10:08
Enter ".help" for usage hints.
sqlite> .tables
sessions  users   
sqlite> PRAGMA table_info(users);
0|userID|TEXT|1||1
1|username|TEXT|1||0
2|password|TEXT|1||0
3|admin|INT|1||0
sqlite> SELECT * FROM users;
4413096d9c933359b898b6202288a650|admin|6eea9b7ef19179a06954edd0f6c05ceb|1
23023b67a32488588db1e28579ced7ec|Bob|ad0234829205b9033196ba818f7a872b|1
4e8423b514eef575394ff78caed3254d|Alice|268b38ca7b84f44fa0a6cdc86e6301e0|0
```

Crack the hash. What is the admin's plaintext password?

Login as the admin. What is the flag?
